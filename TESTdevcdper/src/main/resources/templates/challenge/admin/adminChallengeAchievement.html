<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="@{layout/challengeAdminDefault}">
<th:block layout:fragment="pageTitle">
	<title th:text="${title}"></title>
	<div class="col-sm-6">
		<h1 class="m-0">!챌린지 달성율 관리</h1>
	</div><!-- /.col -->
	<br><br>
	<div class="col-sm-12">
		<ol class="breadcrumb float-sm-right">
			<div class="card-body table-responsive pad">
				<div class="btn-group btn-group-toggle" data-toggle="buttons">
					<a th:href="@{/adminChallenge}" class="btn btn-outline-info">
						<input type="radio" name="options" id="option_a1" autocomplete="off" th:checked="${radioCheck == 'adminChallenge'}"> 챌린지 관리
					</a>
					<a th:href="@{/adminChallengeParticipation}" class="btn btn-outline-info">
						<input type="radio" name="options" id="option_a3" autocomplete="off" th:checked="${radioCheck == 'adminChallengeParticipation'}"> 챌린지 참여 관리
					</a>
					<a th:href="@{/adminChallengeReport}" class="btn btn-outline-info">
						<input type="radio" name="options" id="option_a3" autocomplete="off" th:checked="${radioCheck == 'adminChallengeReport'}"> 챌린지 신고 관리
					</a>
					<a th:href="@{/adminChallengeAchievement}" class="btn btn-outline-info">
						<input type="radio" name="options" id="option_a3" autocomplete="off" th:checked="${radioCheck == 'adminChallengeAchievement'}"> 챌린지 달성율 관리
					</a>
					<a th:href="@{/adminChallengeRanking}" class="btn btn-outline-info">
						<input type="radio" name="options" id="option_a3" autocomplete="off" th:checked="${radioCheck == 'adminChallengeRanking'}"> 챌린지 최종순위 관리
					</a>
					<a th:href="@{/adminChallengeCompensation}" class="btn btn-outline-info">
						<input type="radio" name="options" id="option_a3" autocomplete="off" th:checked="${radioCheck == 'adminChallengeCompensation'}"> 챌린지 보상지급 관리
					</a>
				</div>
			</div>
			
		</ol>
	</div>
</th:block>



<th:block layout:fragment="container">

<div class="card card-default">
			<div class="card-body">
			    <section class="content" id="challengeExplorationSection">
			        <div class="container-fluid">
			            <h2 class="text-center display-5">챌린지 달성율내역 상세검색</h2>
			            <form action="enhanced-results.html">
			                <div class="row">
			                
			                
                             <div class="col-md-10 offset-md-1">
                                 <div class="row">
                                 	<div class="col-4">
			                                <div class="form-group">
			                                    <label>성공횟수</label>
			                                    <select class="js-example-placeholder-single js-states form-control" style="width: 100%;" data-select2-id="6" tabindex="-1" aria-hidden="true">
							                          <option selected="selected">전체</option>
							                          <option>0~10회</option>
							                          <option>10~20회</option>
							                          <option>20~30회</option>
							                          <option>30~40회</option>
							                          <option>40~50회</option>
							                          <option>50회 이상</option>
                                   				 </select>
			                                </div>
			                            </div>
                                 	<div class="col-4">
			                                <div class="form-group">
			                                    <label>총횟수</label>
			                                    <select class="js-example-placeholder-single js-states form-control" style="width: 100%;" data-select2-id="6" tabindex="-1" aria-hidden="true">
							                          <option selected="selected">전체</option>
							                          <option>0~10회</option>
							                          <option>10~20회</option>
							                          <option>20~30회</option>
							                          <option>30~40회</option>
							                          <option>40~50회</option>
							                          <option>50회 이상</option>
                                   				 </select>
			                                </div>
			                            </div>
			                            <div class="col-4" data-select2-id="11">
			                                <div class="form-group" data-select2-id="10">
			                                    <label>달성율</label>
			                                    <select class="js-example-placeholder-single js-states form-control">
			                                    	<option selected="selected">전체</option>
			                                        <option>0~10%</option>
			                                        <option>10~20%</option>
			                                        <option>20~30%</option>
			                                        <option>30~40%</option>
			                                        <option>40~50%</option>
			                                        <option>50~60%</option>
			                                        <option>60~70%</option>
			                                        <option>70~80%</option>
			                                        <option>80~90%</option>
			                                        <option>90~100%</option>
			                                    </select>
			                                </div>
			                            </div>
			                             <div class="col-4">
                                         <div class="form-group">
                                             <label>성공횟수별 정렬</label>
                                             <select class="js-example-placeholder-single js-states form-control">
			                                    	<option selected="selected">전체</option>
			  										<option>많은순</option>
			                                        <option>적은순</option>
											</select>
                                         </div>
                                     </div>
                                     <div class="col-4">
                                         <div class="form-group">
                                             <label>총횟수별 정렬</label>
                                             <select class="js-example-placeholder-single js-states form-control">
			                                    	<option selected="selected">전체</option>
			  										<option>많은순</option>
			                                        <option>적은순</option>
											</select>
                                         </div>
                                     </div>
                                     <div class="col-4">
                                         <div class="form-group">
                                             <label>달성율별 정렬</label>
                                             <select class="js-example-placeholder-single js-states form-control">
			                                    	<option selected="selected">전체</option>
			  										<option>높은순</option>
			                                        <option>낮은순</option>
											</select>
                                         </div>
                                     </div>
			                            
                                     <div class="col-3">
                                         <div class="form-group">
                                             <label>업데이트일자 기간선택</label>
                                             <input type="date" id="adminChallengeStartDate" class="form-control" placeholder="챌린지 시작일을 선택해주세요.">
                                         </div>
                                     </div>
                                     <div class="col-3">
                                         <div class="form-group">
                                             <label>&emsp;</label>
                                             <input type="date" id="adminChallengeEndDate" class="form-control" placeholder="챌린지 종료일을 선택해주세요.">
                                         </div>
                                     </div>
                                     <div class="col-2" data-select2-id="11">
			                                <div class="form-group" data-select2-id="10">
			                                    <label>&emsp;</label>
			                                    <select class="js-example-placeholder-single js-states form-control">
			                                    	<option selected="selected">전체</option>
			                                        <option data-select2-id="16">지난 1일</option>
			                                        <option data-select2-id="16">지난 1주</option>
			                                        <option data-select2-id="16">지난 1개월</option>
			                                        <option data-select2-id="16">지난 1년</option>
			                                    </select>
			                                </div>
			                            </div>
                                      <div class="col-2">
                                         <div class="form-group">
                                             <label>기간별 정렬기준</label>
                                             <select class="js-example-placeholder-single js-states form-control">
			                                    	<option selected="selected">전체</option>
			  										<option>시작일 기준</option>
			                                        <option>종료일 기준</option>
											</select>
                                         </div>
                                     </div>
                                     <div class="col-2">
                                         <div class="form-group">
                                             <label>정렬기준</label>
                                             <select class="js-example-placeholder-single js-states form-control">
			                                    	<option selected="selected">전체</option>
			  										<option>최신순</option>
			                                        <option>오래된순</option>
											</select>
                                         </div>
                                     </div>
                                    
                                 </div>
                                 <div class="form-group">
                                     <div class="input-group input-group-lg">
                                        <div class="col-2">
                                            <div class="form-group">
			                                    <label>검색옵션</label>
			                                    <select class="js-example-placeholder-single js-states form-control">
			                                    	<option selected="selected">전체</option>
			  										<option>챌린지명</option>
			  										<option>개설자 이메일</option>
			  										<option>참여자 이메일</option>
			  										<option>태그</option>
												</select>
			                                </div>
                                        </div>
                                        <input type="search" class="form-control form-control-lg" style="margin-top : 25px;" placeholder="검색어를 입력해주세요" value="">
                                         <div class="input-group-append">
                                             <button type="button" class="btn btn-lg btn-default btn-sm" th:onclick="|location.href='@{#}'|" style="height : 49px;margin-top : 25px;">
                                                 <i class="fa fa-search"></i>
                                             </button>
                                         </div>
                                     </div>
                                 </div>
                             </div>
                         </div>
                     </form>
                 </div>
             </section>
            </div>
       </div>
       <!-- /검색-->

<div class="row">
         <div class="col-12">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">
                <ion-icon size="small" name="list-outline"></ion-icon>
					&emsp; 챌린지 달성율 목록</h3>
                <div class="card-tools">
                	<button type="button" th:onclick="|location.href='@{adminChallengeRanking}'|" class="btn btn-outline-primary">
						최종 순위 리스트
					</button>
                  <div class="input-group input-group-sm" style="width: 150px;">
                    <div class="input-group-append">
                    </div>
                  </div>
                </div>
              </div>
        <div class="card-body table-responsive p-0">
         <table class="table table-striped text-nowrap">
              <thead>
                  <tr>
                      <th>번호</th>
                      <th>챌린지명</th>
                      <th>챌린지 참여자 이메일</th>
                      <th>챌린지 성공횟수</th>
                      <th>챌린지 총횟수</th>
                      <th>챌린지 달성율</th>
                      <th>챌린지 순위</th>
                      <th style="width: 8%" class="text-center">
                       	달성율 업데이트일자
                      </th>
                      <th>삭제</th>
                  </tr>
              </thead>
              <tbody>
                  <tr th:if="${#lists.size(challengeAchievementRateList) > 0}" th:each="l, idx : ${challengeAchievementRateList}">
                      <td id="indexCount" th:text="${idx.count}"></td>
                      <td id="challengeName" th:text="${l.challenge.challengeName}"></td>
                      <td id="userEmail" th:text="${l.normalUser.userEmail}"></td>
                      <td id="challengeAchievementRateSuccesCount" th:text="${l.challengeAchievementRateSuccesCount}"></td>
                      <td id="challengeAchievementRateTotalTimes" th:text="${l.challengeAchievementRateTotalTimes}"></td>
                      <td class="project_progress">
                          <div class="progress progress-sm">
                              <div class="progress-bar bg-blue" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 50%">
                              </div>
                          </div>
                          <small th:text="${#numbers.formatDecimal((l.challengeAchievementRateSuccesCount/l.challengeAchievementRateTotalTimes*100),1,1)}">
                              50% Complete
                          </small>
                      </td>
                      <td>3위</td>
                      <td>2021년 04월 28일</td>
                      <td>
						<button type="button" class="btn btn-block btn-default btn-xs">삭제</button>
					  </td>
                  </tr>
              </tbody>
         </table>
			</div>
			<!-- /.card-body -->
			<!-- 코치 list 페이지번호  -->
			<div class="card-footer clearfix">
		                <ul class="pagination pagination-sm m-0 float-right">
		                  <li class="page-item"><a class="page-link" href="#">«</a></li>
		                  <li class="page-item"><a class="page-link" href="#">1</a></li>
		                  <li class="page-item"><a class="page-link" href="#">2</a></li>
		                  <li class="page-item"><a class="page-link" href="#">3</a></li>
		                  <li class="page-item"><a class="page-link" href="#">4</a></li>
		                  <li class="page-item"><a class="page-link" href="#">5</a></li>
		                  <li class="page-item"><a class="page-link" href="#">»</a></li>
		                </ul>
			   </div>	
		</div>
		</div>
		</div>
		
		
		<div class="card card-primary">
              <div class="card-header">
                <h3 class="card-title">달성율 한눈에 보기</h3>

                <div class="card-tools">
                </div>
              </div>
              <div class="card-body">
					<div class="wrapper">
					<canvas id="myChart4"></canvas>
					</div>
              </div>
              <!-- /.card-body -->
            </div>
		<style>
			
			canvas{
			  background:#fff;
			  height:400px;
			}
		</style>
		
		<!-- <div class="card card-success">
              <div class="card-header">
                <h3 class="card-title">달</h3>

                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="collapse">
                    <i class="fas fa-minus"></i>
                  </button>
                  <button type="button" class="btn btn-tool" data-card-widget="remove">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </div>
              <div class="card-body">
					<div class="wrapper">
					<canvas id="bar-chart" width="600" height="350"></canvas>
					</div>
              </div>
              /.card-body
            </div> -->
		
				

<!-- challenge Modal 영역 시작-->
	<!-- 챌린지 달성율정보 상세보기 Modal - challengeModalAchievementDetail -->
	<th:block th:replace="/fragments/challengeModal/adminChallengeModal/challengeModalAchievementDetail :: challengeModalAchievementDetail"></th:block>
	<!-- challenge Modal 영역 끝 -->

</th:block>


<th:block layout:fragment="pageJavascript">
<script type="text/javascript" th:inline="javascript">
	<!-- 챌린지 달성율정보 상세보기 Modal - challengeModalAchievementDetail -->
		
		var challengeModalAchievementDetail = $('.challengeModalAchievementDetail');
		
		/* Modal 영역 */
		$(function(){
			challengeModalAchievementDetail.click(function(){
			$("#modal-ChallengeModalAchievementDetail").modal();
		});
	});
</script>

<script type="text/javascript" th:inline="javascript">


var ctx = document.getElementById("myChart4").getContext('2d');
var myChart = new Chart(ctx, {
  type: 'bar',
  data: {
    labels: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],
    datasets: [{
      label: '총횟수',
      backgroundColor: "#caf270",
      data: [12, 59, 5, 56, 58,12, 59, 87, 45, 30, 40, 50],
    }, {
      label: '성공횟수',
      backgroundColor: "#008d93",
      data: [12, 59, 5, 56, 58,12, 59, 65, 51, 60, 70, 80],
    }, {
      label: '달성율',
      backgroundColor: "#2e5468",
      data: [12, 59, 5, 56, 58, 12, 59, 12, 74, 90, 80, 70],
    }],
  },
options: {
    tooltips: {
      displayColors: true,
      callbacks:{
        mode: 'x',
      },
    },
    scales: {
      xAxes: [{
        stacked: true,
        gridLines: {
          display: false,
        }
      }],
      yAxes: [{
        stacked: true,
        ticks: {
          beginAtZero: true,
        },
        type: 'linear',
      }]
    },
    responsive: true,
    maintainAspectRatio: false,
    legend: { position: 'bottom' },
  }
});

		
</script>

<!-- <script type="text/javascript" th:inline="javascript">
// Return with commas in between
var numberWithCommas = function(x) {
  return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
};

var dataPack1 = [40, 47, 44, 38, 27];
var dataPack2 = [10, 12, 7, 5, 4];
var dataPack3 = [17, 11, 22, 18, 12];
var dates = ["Some l-o-o-o-o-o-o-o-o-o-o-o-n-n-n-n-n-n-g-g-g-g-g-g-g label", "AAA", "BBB", "CCC", "DDDDDDDDD"];

var bar_ctx = document.getElementById('bar-chart');

var bar_chart = new Chart(bar_ctx, {
  type: 'bar',
  data: {
      labels: dates,
      datasets: [
      {
          label: 'Bad Style',
          data: dataPack1,
						backgroundColor: "#512DA8",
						hoverBackgroundColor: "#7E57C2",
						hoverBorderWidth: 0
      },
      {
          label: 'Warning',
          data: dataPack2,
						backgroundColor: "#FFA000",
						hoverBackgroundColor: "#FFCA28",
						hoverBorderWidth: 0
      },
      {
          label: 'Error',
          data: dataPack3,
						backgroundColor: "#D32F2F",
						hoverBackgroundColor: "#EF5350",
						hoverBorderWidth: 0
      },
      ]
  },
  options: {
   		animation: {
      	duration: 10,
      },
      tooltips: {
					mode: 'label',
        callbacks: {
        label: function(tooltipItem, data) { 
        	return data.datasets[tooltipItem.datasetIndex].label + ": " + numberWithCommas(tooltipItem.yLabel);
        }
        }
       },
      scales: {
        xAxes: [{ 
        	stacked: true, 
          gridLines: { display: false },
          }],
        yAxes: [{ 
        	stacked: true, 
          ticks: {
      			callback: function(value) { return numberWithCommas(value); },
   				}, 
          }],
      },
      legend: {display: true}
  },
  plugins: [{
  beforeInit: function (chart) {
    chart.data.labels.forEach(function (value, index, array) {
      var a = [];
      a.push(value.slice(0, 5));
      var i = 1;
      while(value.length > (i * 5)){
      	a.push(value.slice(i * 5, (i + 1) * 5));
          i++;
      }
      array[index] = a;
    })
  }
}]
 }
);

</script>
 -->
</th:block>
</html>